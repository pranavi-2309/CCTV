# ğŸ“Š GATE PASS WORKFLOW - VISUAL DATA FLOW DIAGRAM

## Complete Request & Response Cycle

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     STUDENT GENERATES GATE PASS                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Student Fills Form
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Student Portal - Gate Pass Form         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœï¸  Student Name: John Doe              â”‚
â”‚ âœï¸  Roll Number: 2101                   â”‚
â”‚ âœï¸  Year: 2nd Year          â† NEW FIELD â”‚
â”‚ âœï¸  Department: CS          â† NEW FIELD â”‚
â”‚ âœï¸  Reason: Medical         â† NEW FIELD â”‚
â”‚ âœï¸  TimeOut: 14:00          â† NEW FIELD â”‚
â”‚                                         â”‚
â”‚ [Generate Gate Pass]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
          
STEP 2: Preview Generated (NO STORAGE)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Preview Modal (jsPDF)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Gate Pass                         â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ Student: John Doe                 â”‚  â”‚
â”‚ â”‚ Roll: 2101                        â”‚  â”‚
â”‚ â”‚ Year: 2nd Year                    â”‚  â”‚
â”‚ â”‚ Reason: Medical                   â”‚  â”‚
â”‚ â”‚ TimeOut: 14:00                    â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚ âœ… Not stored to localStorage yet!     â”‚
â”‚ âœ… Only preview shown                  â”‚
â”‚ [Send to HOD] [Cancel]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    STUDENT SENDS REQUEST TO HOD                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 3: sendGatePassRequest() Called
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript Function: sendGatePassRequest()                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Collect Data:                                                   â”‚
â”‚   name: "John Doe"                                              â”‚
â”‚   roll: "2101"                                                  â”‚
â”‚   year: "2nd Year"                 â† NEW                        â”‚
â”‚   department: "CS"                 â† NEW                        â”‚
â”‚   reason: "Medical"                â† NEW                        â”‚
â”‚   timeOut: "14:00"                 â† NEW                        â”‚
â”‚   status: "pending_approval"                                    â”‚
â”‚   studentEmail: "student@example.com"  â† NEW                   â”‚
â”‚                                                                 â”‚
â”‚ Build Request Body:                                             â”‚
â”‚ {                                                               â”‚
â”‚   "studentName": "John Doe",                                    â”‚
â”‚   "studentRoll": "2101",                                        â”‚
â”‚   "studentYear": "2nd Year",       â† NEW                        â”‚
â”‚   "department": "CS",              â† NEW                        â”‚
â”‚   "reason": "Medical",             â† NEW                        â”‚
â”‚   "timeOut": "14:00",              â† NEW                        â”‚
â”‚   "status": "pending_approval",                                 â”‚
â”‚   "studentEmail": "student@example.com",  â† NEW                â”‚
â”‚   "userId": "student123",                                       â”‚
â”‚   "hodSectionId": "section456"                                  â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ POST to: /api/gatepasses                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“ HTTP POST (Network)
          â†“


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  BACKEND RECEIVES & STORES REQUEST                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 4: GatePassController.java Receives POST
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ REST Endpoint: POST /api/gatepasses                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @PostMapping                                                     â”‚
â”‚ public ResponseEntity<GatePass> createGatePass(                 â”‚
â”‚   @RequestBody GatePass gatePass) {                             â”‚
â”‚     return ResponseEntity.status(HttpStatus.CREATED)            â”‚
â”‚       .body(gatePassRepository.save(gatePass));                 â”‚
â”‚ }                                                                â”‚
â”‚                                                                  â”‚
â”‚ Receives JSON:                                                   â”‚
â”‚ {                                                                â”‚
â”‚   "studentName": "John Doe",                                     â”‚
â”‚   "studentRoll": "2101",                                         â”‚
â”‚   "studentYear": "2nd Year",       â† Saved to database!         â”‚
â”‚   "department": "CS",              â† Saved to database!         â”‚
â”‚   "reason": "Medical",             â† Saved to database!         â”‚
â”‚   "timeOut": "14:00",              â† Saved to database!         â”‚
â”‚   "status": "pending_approval",    â† Important: Status set      â”‚
â”‚   "studentEmail": "student@example.com",  â† Saved              â”‚
â”‚   ...                                                            â”‚
â”‚ }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
          
STEP 5: MongoDB Stores Document
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Collection: gatepasses                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Document Created:                                                â”‚
â”‚ {                                                                â”‚
â”‚   "_id": ObjectId("6904f15dbb0c54a61ed46fbc"),                  â”‚
â”‚   "studentName": "John Doe",                                     â”‚
â”‚   "studentRoll": "2101",                                         â”‚
â”‚   "studentYear": "2nd Year",       âœ… NEW - Persisted           â”‚
â”‚   "department": "CS",              âœ… NEW - Persisted           â”‚
â”‚   "reason": "Medical",             âœ… NEW - Persisted           â”‚
â”‚   "timeOut": "14:00",              âœ… NEW - Persisted           â”‚
â”‚   "status": "pending_approval",    âœ… Status = Pending          â”‚
â”‚   "studentEmail": "student@example.com",  âœ… For HOD view      â”‚
â”‚   "userId": "student123",                                        â”‚
â”‚   "hodSectionId": "section456",                                  â”‚
â”‚   "createdAt": ISODate("2025-10-31T23:10:00Z"),                â”‚
â”‚   "issuedAt": ISODate("2025-10-31T23:10:00Z")                  â”‚
â”‚ }                                                                â”‚
â”‚                                                                  â”‚
â”‚ Response to Frontend (201 Created):                              â”‚
â”‚ HTTP/1.1 201 Created                                             â”‚
â”‚ Content-Type: application/json                                   â”‚
â”‚                                                                  â”‚
â”‚ {                                                                â”‚
â”‚   "_id": "6904f15dbb0c54a61ed46fbc",                            â”‚
â”‚   ... (all fields returned)                                      â”‚
â”‚ }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“ HTTP 201 Response
          â†“


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              HOD REVIEWS PENDING REQUEST IN HOD PORTAL                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 6: renderHodGatePassList() Displays Data
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HOD Portal - Gate Pass Requests                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pending Requests:                                                â”‚
â”‚                                                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Request #1                                                 â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Student: John Doe                                          â”‚ â”‚
â”‚ â”‚ Roll: 2101                                                 â”‚ â”‚
â”‚ â”‚ Year: 2nd Year        âœ… Now displays (not "â€”")            â”‚ â”‚
â”‚ â”‚ Reason: Medical       âœ… Now displays (not "â€”")            â”‚ â”‚
â”‚ â”‚ TimeOut: 14:00        âœ… Now displays (not "â€”")            â”‚ â”‚
â”‚ â”‚ Status: â³ Pending Approval                               â”‚ â”‚
â”‚ â”‚                                                            â”‚ â”‚
â”‚ â”‚ [âœ… Approve] [âŒ Decline]                                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ âœ… All fields displayed correctly from database!               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     HOD CLICKS APPROVE BUTTON                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 7: approveGatePass() Called
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript: approveGatePass(id)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id = "6904f15dbb0c54a61ed46fbc"                                  â”‚
â”‚                                                                  â”‚
â”‚ PATCH Request:                                                   â”‚
â”‚ URL: /api/gatepasses/6904f15dbb0c54a61ed46fbc/approve           â”‚
â”‚ Method: PATCH                                                    â”‚
â”‚ Headers: Content-Type: application/json                          â”‚
â”‚                                                                  â”‚
â”‚ Expected Response: HTTP 200 OK                                   â”‚
â”‚ {                                                                â”‚
â”‚   "_id": "6904f15dbb0c54a61ed46fbc",                            â”‚
â”‚   "status": "approved",            â† Changed from "pending_app" â”‚
â”‚   "approvedAt": "2025-10-31T23:11:00Z"  â† Timestamp added      â”‚
â”‚   ... (all other fields unchanged)                               â”‚
â”‚ }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“ PATCH /api/gatepasses/{id}/approve
          â†“


STEP 8: Backend Approves & Updates
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GatePassController.java                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ @PatchMapping("/{id}/approve")                                   â”‚
â”‚ public ResponseEntity<?> approveGatePass(@PathVariable String id) â”‚
â”‚ {                                                                â”‚
â”‚     GatePass result = gatePassService.approveGatePass(id);       â”‚
â”‚     if (result != null) {                                        â”‚
â”‚         return ResponseEntity.ok(result);  â† 200 OK             â”‚
â”‚     }                                                            â”‚
â”‚     return ResponseEntity.notFound().build(); â† 404 if not foundâ”‚
â”‚ }                                                                â”‚
â”‚                                                                  â”‚
â”‚ Calls: GatePassService.approveGatePass(id)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
          
STEP 9: Service Updates Document
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GatePassService.java                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ public GatePass approveGatePass(String id) {                     â”‚
â”‚     Optional<GatePass> opt = gatePassRepository.findById(id);    â”‚
â”‚     if (opt.isPresent()) {                                       â”‚
â”‚         GatePass gp = opt.get();                                 â”‚
â”‚         gp.setStatus("approved"); â† Status changed!             â”‚
â”‚         gp.setApprovedAt(LocalDateTime.now()); â† Timestamp set  â”‚
â”‚         return gatePassRepository.save(gp); â† Saved to MongoDB   â”‚
â”‚     }                                                            â”‚
â”‚     return null;                                                 â”‚
â”‚ }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
          
STEP 10: MongoDB Document Updated
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Collection: gatepasses (Document Updated)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Document State BEFORE:                                           â”‚
â”‚ {                                                                â”‚
â”‚   "_id": ObjectId("6904f15dbb0c54a61ed46fbc"),                  â”‚
â”‚   "studentName": "John Doe",                                     â”‚
â”‚   "status": "pending_approval",    â† OLD STATUS                 â”‚
â”‚   "approvedAt": null                                             â”‚
â”‚ }                                                                â”‚
â”‚                                                                  â”‚
â”‚ â†“â†“â†“ SERVICE UPDATES â†“â†“â†“                                         â”‚
â”‚                                                                  â”‚
â”‚ Document State AFTER:                                            â”‚
â”‚ {                                                                â”‚
â”‚   "_id": ObjectId("6904f15dbb0c54a61ed46fbc"),                  â”‚
â”‚   "studentName": "John Doe",                                     â”‚
â”‚   "status": "approved",            â† NEW STATUS âœ…              â”‚
â”‚   "approvedAt": ISODate("2025-10-31T23:11:00Z")  â† Timestamp âœ…â”‚
â”‚ }                                                                â”‚
â”‚                                                                  â”‚
â”‚ Response: HTTP 200 OK with updated document                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“ HTTP 200 Response
          â†“


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            STUDENT CHECKS HISTORY & SEES APPROVED REQUEST                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 11: Student Logs In & Checks History
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Student Portal - Gate Pass History                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚ GET /api/gatepasses/user/student123                              â”‚
â”‚ Response:                                                        â”‚
â”‚ [                                                                â”‚
â”‚   {                                                              â”‚
â”‚     "_id": "6904f15dbb0c54a61ed46fbc",                          â”‚
â”‚     "studentName": "John Doe",                                   â”‚
â”‚     "status": "approved",          â† Status is NOW "approved"   â”‚
â”‚     "approvedAt": "2025-10-31T23:11:00Z"                        â”‚
â”‚     "reason": "Medical",                                         â”‚
â”‚     "timeOut": "14:00",                                          â”‚
â”‚     ...                                                          â”‚
â”‚   }                                                              â”‚
â”‚ ]                                                                â”‚
â”‚                                                                  â”‚
â”‚ Filter Logic (renderStudentGatePassList):                        â”‚
â”‚ if (status === 'approved' || status === 'declined')             â”‚
â”‚   âœ… Show in history                                            â”‚
â”‚ else if (status === 'pending_approval')                         â”‚
â”‚   âŒ Hide from history                                          â”‚
â”‚                                                                  â”‚
â”‚ Display:                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… Gate Pass Approved                                      â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Reason: Medical                                            â”‚ â”‚
â”‚ â”‚ TimeOut: 14:00                                             â”‚ â”‚
â”‚ â”‚ Status: âœ… Approved                                        â”‚ â”‚
â”‚ â”‚ Approved On: 2025-10-31 23:11                              â”‚ â”‚
â”‚ â”‚                                                            â”‚ â”‚
â”‚ â”‚ [ğŸ“¥ Download as PDF]                                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“


STEP 12: Student Downloads PDF
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ downloadGatePass(id) Called                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Uses: jsPDF + html2canvas                                        â”‚
â”‚ Generates PDF with:                                              â”‚
â”‚   - Student Name: John Doe                                       â”‚
â”‚   - Roll: 2101                                                   â”‚
â”‚   - Year: 2nd Year                                               â”‚
â”‚   - Reason: Medical                                              â”‚
â”‚   - TimeOut: 14:00                                               â”‚
â”‚   - Approved Date: 2025-10-31                                    â”‚
â”‚   - Gate Pass ID: 6904f15dbb0c54a61ed46fbc                      â”‚
â”‚                                                                  â”‚
â”‚ Download: gatepass_JohnDoe_31-10-2025.pdf                       â”‚
â”‚                                                                  â”‚
â”‚ âœ… PDF Downloaded Successfully                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        âœ… COMPLETE WORKFLOW SUCCESSFUL
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“Š KEY TRANSFORMATION: Status Field

```
Timeline:

Time 0: Student fills form
  â””â”€â†’ No status yet (just form data)

Time 1: Student clicks "Generate"
  â””â”€â†’ Status: (no storage)

Time 2: Student clicks "Send to HOD"
  â””â”€â†’ Status: "pending_approval" âœ… (sent to backend)

Time 3: HOD sees request in portal
  â””â”€â†’ Status: "pending_approval" (displayed to HOD)

Time 4: HOD clicks "Approve"
  â””â”€â†’ Status: "approved" âœ… (updated in database)

Time 5: Student checks history
  â””â”€â†’ Status: "approved" (visible in history now)
  â””â”€â†’ Download enabled âœ…

Time 6: Student downloads PDF
  â””â”€â†’ Status: "approved" (PDF contains this status)
```

---

## ğŸ¯ Data Field Journey

```
Field: "Year" (studentYear) - Example value: "2nd Year"

Step 1: Student enters in form
  â”œâ”€â†’ Input captured in HTML: <select id="letterYear">
  â””â”€â†’ Value: "2nd Year"

Step 2: Student clicks "Send to HOD"
  â”œâ”€â†’ Read from form: document.getElementById('letterYear').value
  â””â”€â†’ Added to request: { studentYear: "2nd Year" }

Step 3: Sent to backend
  â”œâ”€â†’ HTTP POST body contains studentYear
  â””â”€â†’ Backend receives via @RequestBody GatePass

Step 4: MongoDB saves document
  â”œâ”€â†’ Document includes: studentYear: "2nd Year"
  â””â”€â†’ Persisted in database

Step 5: HOD views request
  â”œâ”€â†’ Backend returns gate pass document
  â”œâ”€â†’ Frontend displays: ${gp.studentYear}
  â””â”€â†’ HOD sees: "2nd Year" âœ… (not "â€”")

Step 6: Student sees in history
  â”œâ”€â†’ Backend returns gate passes
  â”œâ”€â†’ Filter logic allows display (approved status)
  â””â”€â†’ Student sees: "2nd Year" âœ…

Step 7: PDF download
  â”œâ”€â†’ HTML captured includes field value
  â””â”€â†’ PDF contains: "Year: 2nd Year" âœ…
```

---

## âœ… VALIDATION CHECKLIST

After each step, verify:

1. **After Generation**
   âœ… Preview appears
   âœ… localStorage empty

2. **After Send to HOD**
   âœ… No 404 error (should be 201)
   âœ… Gate pass ID generated
   âœ… Check MongoDB: `db.gatepasses.findOne({})`

3. **HOD Reviews**
   âœ… Request visible in HOD portal
   âœ… All fields displayed (not "â€”")
   âœ… Status shows: "pending_approval"

4. **After Approve**
   âœ… No 404 error (should be 200)
   âœ… Request disappears from HOD list
   âœ… Status in DB: "approved"

5. **Student History**
   âœ… Gate pass visible
   âœ… Status shows: "Approved"
   âœ… Download button enabled

6. **After Download**
   âœ… PDF generated
   âœ… PDF contains all data
   âœ… File saved successfully

